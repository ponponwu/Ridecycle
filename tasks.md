# 二手腳踏車交易平台 (Pedal Palace) MVP 開發任務清單

## 前置準備

### 1. 專案設置

-   [x] **建立 Rails API 專案**

    -   使用 `rails new backend --api -d postgresql` 創建專案
    -   配置 Gemfile，添加必要的 gem
    -   設置 CORS 和跨域請求配置

-   [x] **設置 React 前端專案**
    -   使用 `npx create-react-app frontend --template typescript` 創建專案
    -   配置 package.json，添加必要的依賴
    -   設置 Tailwind CSS
    -   整合 Shadcn UI 組件

### 2. 資料庫設計與設置

-   [x] **設計並創建 User 模型**

    -   定義必要的欄位: email, password_digest, name, created_at, updated_at
    -   設置驗證規則
    -   實現 `has_secure_password`

-   [x] **設計並創建 RefreshToken 模型**

    -   定義欄位: user_id, token, expires_at, revoked_at, created_at, updated_at
    -   設置與 User 的關聯
    -   實現 token 有效性檢查方法

-   [x] **設計並創建 Bicycle 模型**

    -   定義必要欄位
    -   設置 Active Storage 關聯
    -   設置與 User 的關聯
    -   實現基本的驗證規則

-   [x] **設計並創建 Message 模型**

    -   定義欄位: sender_id, recipient_id, content, bicycle_id, is_read
    -   設置與 User 和 Bicycle 的關聯
    -   設置基本驗證規則

-   [x] **設計並創建 Order 模型**
    -   定義欄位: user_id, bicycle_id, total_price, status, shipping_address, payment_details
    -   設置關聯與狀態枚舉
    -   實現訂單號生成邏輯

## 後端實現

### 3. 認證系統

-   [x] **實現 UserSerializer**

    -   定義用戶序列化格式
    -   排除敏感資訊

-   [x] **實現 JWT Token 工具方法**

    -   在 ApplicationController 中添加 JWT 編碼/解碼方法
    -   實現 token 生成與驗證邏輯
    -   配置 cookie 設置方法

-   [x] **實現 AuthController**

    -   創建註冊 endpoint (register)
    -   創建登入 endpoint (login)
    -   創建登出 endpoint (logout)
    -   實現當前用戶資訊 endpoint (me)

-   [x] **實現 RefreshController**

    -   實現 token 刷新邏輯
    -   處理 token 失效情況

-   [x] **配置 CSRF 保護**

    -   設置 CSRF token 端點
    -   實現 CSRF cookie 設置邏輯
    -   配置請求驗證

-   [ ] **實現 OmniAuth 集成**
    -   配置 Google OAuth
    -   配置 Facebook OAuth
    -   實現 SessionsController 處理回調

### 4. 腳踏車管理 API

-   [x] **實現 BicycleSerializer**

    -   定義基本欄位序列化
    -   處理圖片 URL 生成
    -   添加關聯資訊

-   [x] **實現 ImageUploadService**

    -   創建圖片上傳和處理服務
    -   實現圖片變體生成邏輯

-   [x] **實現 BicyclesController 基本功能**

    -   實現 index 方法 (列表查詢)
    -   實現 show 方法 (單車詳情)
    -   實現 create 方法 (上架新車)
    -   實現 update 方法 (更新資訊)
    -   實現 destroy 方法 (下架)

-   [ ] **實現腳踏車進階搜尋功能**

    -   添加過濾參數處理
    -   實現按類型、價格、品牌等條件過濾
    -   設置排序邏輯

-   [ ] **實現用戶腳踏車管理**
    -   實現 `my_bicycles` 端點
    -   添加狀態變更功能 (標記為已售)

### 5. 訊息系統

-   [x] **實現 MessageSerializer**

    -   定義訊息序列化格式
    -   包含發送者和接收者資訊

-   [x] **實現 MessagesController**
    -   實現獲取對話列表功能
    -   實現發送訊息功能
    -   實現獲取特定對話訊息功能
    -   實現訊息已讀標記功能

### 6. 訂單系統

-   [ ] **實現 OrderSerializer**

    -   定義訂單序列化格式
    -   處理敏感付款資訊

-   [ ] **實現 OrdersController 基本功能**
    -   實現訂單創建功能
    -   實現用戶訂單列表查詢
    -   實現訂單詳情查詢
    -   實現訂單狀態更新功能

## 前端實現

### 7. 前端基礎設置

-   [x] **設置 API 客戶端**

    -   實現基本 API 客戶端
    -   配置請求攔截器處理認證
    -   實現 CSRF token 處理

-   [x] **實現 AuthContext**

    -   創建認證狀態管理
    -   實現登入/登出方法
    -   實現 token 自動刷新邏輯

-   [x] **實現基礎 UI 組件**
    -   配置基本佈局組件
    -   實現導航欄和頁尾
    -   創建通用按鈕、表單、卡片等組件

### 8. 認證頁面

-   [x] **實現註冊頁面**

    -   創建註冊表單
    -   實現表單驗證
    -   處理註冊提交與錯誤

-   [x] **實現登入頁面**

    -   創建登入表單
    -   添加社交登入按鈕
    -   處理登入提交與錯誤

-   [ ] **實現第三方認證回調頁面**
    -   處理 OAuth 回調邏輯
    -   保存用戶信息到上下文

### 9. 首頁與搜尋

-   [ ] **實現首頁**

    -   創建 Hero 區塊
    -   實現特色腳踏車展示
    -   添加搜尋入口和類別導航

-   [x] **實現搜尋頁面**

    -   創建搜尋表單和過濾器
    -   實現搜尋結果顯示
    -   添加排序和分頁功能

-   [x] **實現 BicycleCard 組件**
    -   設計腳踏車卡片外觀
    -   添加收藏功能
    -   優化圖片載入

### 10. 腳踏車詳情頁

-   [x] **實現基本資訊顯示**

    -   展示標題、價格、位置等資訊
    -   顯示規格和詳細描述
    -   添加賣家資訊區塊

-   [x] **實現圖片展示**

    -   創建圖片輪播組件
    -   實現縮圖預覽
    -   添加圖片放大功能

-   [] **實現聯絡賣家功能**
    -   創建留言表單
    -   實現發送訊息功能
    -   添加出價功能

### 11. 上架腳踏車功能

-   [x] **實現多步驟表單架構**

    -   創建表單狀態管理
    -   實現步驟導航
    -   設計進度指示器

-   [ ] **實現基本資訊步驟**

    -   創建品牌、型號、年份等輸入欄位
    -   添加類型選擇下拉選單
    -   實現表單驗證

-   [ ] **實現照片上傳步驟**

    -   創建拖放上傳區域
    -   實現照片預覽和排序
    -   添加照片刪除功能

-   [ ] **實現定價和位置步驟**

    -   添加價格輸入欄位
    -   實現位置選擇
    -   設置聯絡方式選項

-   [ ] **實現預覽和提交步驟**
    -   顯示所有已填資訊預覽
    -   實現最終提交邏輯
    -   添加上傳進度顯示

### 12. 訊息系統

-   [ ] **實現訊息列表頁面**

    -   顯示對話列表
    -   實現未讀訊息提示
    -   添加最新訊息預覽

-   [ ] **實現對話詳情頁面**

    -   創建訊息列表
    -   實現訊息輸入框
    -   添加發送功能

-   [ ] **實現出價功能**
    -   創建出價表單
    -   實現出價建議功能
    -   添加出價歷史顯示

### 13. 個人中心

-   [x] **實現個人資料頁**

    -   顯示用戶基本資訊
    -   添加資料編輯功能
    -   實現頭像更新

-   [] **實現我的腳踏車頁面**

    -   顯示用戶已發布腳踏車
    -   添加編輯和刪除功能
    -   實現狀態管理

-   [ ] **實現訂單歷史頁面**
    -   顯示購買和銷售紀錄
    -   添加訂單詳情查看
    -   實現訂單狀態追蹤

### 14. 結帳流程

-   [ ] **實現購物車功能**

    -   創建 CartContext
    -   實現添加/移除商品
    -   顯示購物車摘要

-   [ ] **實現送貨資訊頁面**

    -   創建地址表單
    -   實現地址驗證
    -   保存地址資訊

-   [ ] **實現付款頁面**

    -   創建付款表單
    -   模擬付款處理
    -   處理付款錯誤

-   [ ] **實現訂單確認頁面**
    -   顯示訂單摘要
    -   實現最終提交
    -   創建成功頁面

## 系統優化與整合

### 15. 多語言支持

-   [x] **設置 i18next**
    -   配置中文和英文翻譯檔
    -   實現語言切換功能
    -   應用翻譯到所有文本

## 系統優化與整合

### 16. 使用者體驗優化

-   [ ] **實現錯誤處理**

    -   創建錯誤邊界組件
    -   實現全局錯誤處理
    -   添加用戶友好錯誤訊息

-   [ ] **添加載入狀態**

    -   實現頁面載入指示器
    -   添加按鈕載入狀態
    -   優化表單提交體驗

-   [ ] **優化響應式設計**
    -   檢查並調整所有頁面的響應式佈局
    -   優化移動端使用體驗
    -   測試不同設備尺寸

### 17. 部署準備

-   [ ] **設置環境變數**

    -   配置開發和生產環境變數
    -   安全地管理密鑰和敏感資訊

-   [ ] **準備部署腳本**

    -   創建前端構建腳本
    -   設置後端部署配置
    -   準備資料庫遷移腳本

-   [ ] **實現基本監控**
    -   添加錯誤日誌記錄
    -   設置性能監控
    -   準備健康檢查端點
